<?php
function sum_intervals(array $in):int
{
    for($i = 0; $i < Count($in); $i++){
        if($in[$i][0] > $in[$i][1]){
            $in[$i] = [$in[$i][1], $in[$i][0]];
        }
    }
    for($i = 0; $i < Count($in); $i++){
        for($d = 0; $d < Count($in); $d++){
            if($d == $i ){continue;}
            if($in[$i][0] <= $in[$d][0] &&  $in[$d][1] <= $in[$i][1]){
                $in[$d] = [0,0];
            }elseif($in[$d][0] <= $in[$i][0] &&  $in[$i][1] <= $in[$d][1]){
                $in[$i] = [$in[$d][0], $in[$d][1]];
                $in[$d] = [0,0];
            }elseif($in[$i][0] < $in[$d][0] && $in[$d][0] < $in[$i][1] && $in[$i][1] < $in[$d][1]){
                $in[$i] = [$in[$i][0], $in[$d][1]];
                $in[$d] = [0, 0];
            }elseif($in[$d][0] < $in[$i][0] && $in[$i][0] < $in[$d][1] && $in[$d][1] < $in[$i][1]){
                $in[$i] = [$in[$d][0], $in[$i][1]];
                $in[$d] = [0,0];
            }elseif($in[$d][0] < $in[$i][0] && $in[$i][0] == $in[$d][1] && $in[$i][0] < $in[$i][1]){
                $in[$i] = [$in[$d][0], $in[$i][1]];
                $in[$d] = [0,0];
            }elseif($in[$i][0] < $in[$d][0] && $in[$d][0] == $in[$i][1] && $in[$d][0] < $in[$d][1]){
                $in[$i] = [$in[$i][0], $in[$d][1]];
                $in[$d] = [0,0];
            }
        }
    }
    $finalArray = [];
    for($i = 0; $i < Count($in); $i++){
        $finalArray[] = $in[$i][1] - $in[$i][0];
    }
    return array_sum($finalArray);
}
$arr = [[-5, 5], [0, 10], [20,30], [2, 5]];
$arr2 = [[1, 5],[1, 5]];
$arr3  = [[1, 6], [10, 20], [5, 11]];// 19
$arr4 = [[10, 20], [1, 6], [5, 11]];// 19
$arr5 =  [ [1, 5], [10, 20], [1, 6], [16, 19], [5, 11] ];// 19
$arr6 = [[1, 4], [7, 10], [3, 5]];
$arr7 = [
    [ -65, -28 ],
    [ 425, 450 ],
    [ 181, 360 ],
    [ -460, -415 ],
    [ 398, 474 ],
    [ -75, 211 ],
    [ -425, 234 ],
    [ 34, 495 ],
    [ 91, 461 ]
];
$arr8 = [[-105, 114], [200, 286], [307, 487]];
$arr9 = [[-10000000, 10000000],[10000000, 100000000]];
echo sum_intervals($arr9);
//echo sum_intervals($arr4);